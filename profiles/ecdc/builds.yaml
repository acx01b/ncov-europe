# Define locations for which builds should be created.
# For each build we specify a subsampling scheme via an explicit key.
# If the name of the focal geography differs from the build name this needs to
# be specified explicity as geographic_name. In addition, we require the
# geographic scale the build focuses on. Together name and scale serve a look-up
# in the geo_hierarchy to define region, country, division, etc
builds:
  ecdc-europe:
    subsampling_scheme: region
    geographic_scale: region
    region: Europe

  ecdc-russia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Russia
  ecdc-serbia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Serbia
  ecdc-latvia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Latvia
  ecdc-slovakia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Slovakia
  ecdc-slovenia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Slovenia
  ecdc-poland:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Poland
  ecdc-belarus:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Belarus
  ecdc-estonia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Estonia
  ecdc-lithuania:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Lithuania
  ecdc-hungary:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Hungary
  ecdc-croatia:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Croatia
  ecdc-france:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: France
  ecdc-iceland:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Iceland
  ecdc-norway:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Norway
  ecdc-denmark:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Denmark
  ecdc-netherlands:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Netherlands
  ecdc-belgium:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Belgium
  ecdc-luxembourg:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Luxembourg
  ecdc-germany:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Germany
  ecdc-austria:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Austria
  ecdc-switzerland:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Switzerland
  ecdc-italy:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Italy
  ecdc-spain:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Spain
  ecdc-czech-republic:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Czech Republic
  ecdc-united-kingdom:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: United Kingdom
  ecdc-ireland:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Ireland
  ecdc-finland:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Finland
  ecdc-sweden:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Sweden
  ecdc-portugal:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Portugal
  ecdc-greece:
    subsampling_scheme: country
    geographic_scale: country
    region: Europe
    country: Greece


traits:
  default:
    sampling_bias_correction: 2.5
    columns: ["region_exposure"]

exposure:
  default:
    trait: "country"
    exposure: "region_exposure"

files:
  colors: "profiles/ecdc/colors.tsv"
  auspice_config: "profiles/ecdc/auspice_config_ecdc.json"


subsampling:
  # Default subsampling logic for regions
  region:
    # Focal samples for region
    region:
      group_by: "division year month"
      seq_per_group: 96
      exclude: "--exclude-where 'region!={region}'"
    # Contextual samples for region from the rest of the world
    global:
      group_by: "country year month"
      seq_per_group: 10
      exclude: "--exclude-where 'region={region}'"
      priorities:
        type: "proximity"
        focus: "region"

subsampling:
  # Custom subsampling logic for regions like Europe where grouping by country
  # is the smallest resolution required.
  region:
    # Focal samples for region
    region:
      group_by: "country year month"
      seq_per_group: 70
      exclude: "--exclude-where 'region!={region}'"
    # Contextual samples for region from the rest of the world
    global:
      group_by: "country year month"
      seq_per_group: 12
      exclude: "--exclude-where 'region={region}'"
      priorities:
        type: "proximity"
        focus: "region"

  # Default subsampling logic for countries
  country:
    # Focal samples for country
    country:
      group_by: "division year month"
      seq_per_group: 60
      exclude: "--exclude-where 'country!={country}'"
    # Contextual samples from country's region
    region:
      group_by: "country year month"
      seq_per_group: 20
      exclude: "--exclude-where 'country={country}' 'region!={region}'"
      priorities:
        type: "proximity"
        focus: "country"
    # Contextual samples from the rest of the world,
    # excluding the current region to avoid resampling.
    global:
      group_by: "country year month"
      seq_per_group: 10
      exclude: "--exclude-where 'region={region}'"
      priorities:
        type: "proximity"
        focus: "country"
